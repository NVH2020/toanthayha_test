<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề thi thử TN THPT lần 12 - Bắc Giang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .nav-btn { transition: background-color 0.2s, color 0.2s, border-color 0.2s; }
        .nav-btn-answered { background-color: #16a34a; color: white; border-color: #15803d; }
        .nav-btn-current { background-color: #4f46e5; color: white; border-color: #4338ca; transform: scale(1.1); }
        input[type="radio"]:checked + span { font-weight: 600; color: #4f46e5; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div id="main-container" class="w-full max-w-4xl bg-white rounded-xl shadow-lg p-6">
        <h1 class="text-2xl font-bold text-center mb-6">Lớp Toán Thầy Hà-Thi Thử Lần 12</h1>

        <!-- Form nhập thông tin -->
        <div id="userInfoSection" class="max-w-md mx-auto">
            <h2 class="text-xl font-semibold text-center mb-4">Thông tin thí sinh</h2>
            <div class="mb-3">
                <label class="block font-medium">Số báo danh (VD: 540112)</label>
                <input type="text" id="studentId" class="w-full border rounded px-3 py-2 mt-1" required>
            </div>
            <div class="mb-3">
                <label class="block font-medium">Họ và tên</label>
                <input type="text" id="fullname" class="w-full border rounded px-3 py-2 mt-1" required>
            </div>
            <div class="mb-3">
                <label class="block font-medium">Lớp</label>
                <input type="text" id="className" class="w-full border rounded px-3 py-2 mt-1" required>
            </div>
            <div class="mb-3">
                <label class="block font-medium">Trường</label>
                <input type="text" id="school" class="w-full border rounded px-3 py-2 mt-1" required>
            </div>
            <button id="startBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mt-2">Bắt đầu làm bài</button>
        </div>

        <!-- Phần câu hỏi -->
        <div id="quizSection" class="hidden">
            <div id="quiz-header" class="flex justify-between items-start border-b pb-4 mb-4">
                <div>
                    <h2 id="quiz-part-title" class="text-xl md:text-2xl font-bold text-gray-800"></h2>
                    <p class="text-lg font-semibold text-blue-600">
                        Câu <span id="question-counter">1</span> / 25
                    </p>
                </div>
                <div id="timer" class="text-2xl font-bold text-red-500">60:00</div>
            </div>
            
            <div id="questionNavPanel" class="flex flex-wrap gap-2 p-3 border-b mb-4 bg-gray-50 rounded-lg"></div>

            <form id="quizForm" class="space-y-6">
                <div id="question-text" class="text-lg font-medium text-gray-800 min-h-[48px]"></div>
                <div id="answer-container" class="space-y-3"></div>
                
                <div class="flex justify-between items-center pt-4 mt-4 border-t">
                    <button type="button" id="prevBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-2 rounded">Câu trước</button>
                    <button type="submit" id="submitBtn" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded text-lg font-bold">Nộp bài</button>
                    <button type="button" id="nextBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded">Câu sau</button>
                </div>
            </form>
        </div>

        <!-- Màn hình kết quả -->
        <div id="resultSection" class="hidden text-center">
            <h2 id="studentNameResult" class="text-2xl font-bold mb-2"></h2>
            <p class="text-lg mb-4">Đã hoàn thành bài kiểm tra!</p>
            <p class="text-xl">Tổng điểm của bạn là: 
                <span id="finalScore" class="font-bold text-blue-600 text-3xl"></span>
            </p>
            <p class="mt-4 text-gray-600">Kết quả đã được lưu vào hệ thống.</p>
            
            <div class="mt-8 p-4 border-t bg-gray-50 rounded-lg">
                <img src="https://placehold.co/100x100/3B82F6/FBBF24?text=TH%E1%BA%A6Y+H%C3%80&font=times-new-roman&css=%7B%22font-weight%22%3A%22bold%22%2C%22font-size%22%3A%2234px%22%7D" alt="Logo Lớp Toán Thầy Hà" class="mx-auto mb-3 rounded-full">
                <h3 class="text-lg font-bold mb-2">Lớp toán 10 thầy Hà tiếp tục tuyển sinh</h3>
                <p class="text-gray-600">
                    Nhóm dạy ít học sinh(10-15) đảm bảo sát sao và chất lượng, sẽ đánh giá định kỳ.
                    <br>
                    Liên hệ qua Zalo: <strong>0988.948.882</strong>
                </p>
            </div>
        </div>
    </div>

    <!-- Màn hình thông báo (Modal) -->
    <div id="announcementModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-xl shadow-lg p-8 max-w-lg w-full text-center">
            <img src="https://placehold.co/150x150/3B82F6/FBBF24?text=TH%E1%BA%A6Y+H%C3%80&font=times-new-roman&css=%7B%22font-weight%22%3A%22bold%22%2C%22font-size%22%3A%2248px%22%7D" alt="Logo Lớp Toán Thầy Hà" class="mx-auto mb-4 rounded-full">
            <h2 class="text-xl font-bold mb-2">Lớp toán 10 thầy Hà tiếp tục tuyển sinh</h2>
            <p class="text-gray-600 mb-6">
                Nhóm dạy ít học sinh(10-15) đảm bảo sát sao và chất lượng, sẽ đánh giá định kỳ.
                <br>
                Liên hệ qua Zalo: <strong>0988.948.882</strong>
            </p>
            <div class="flex justify-center gap-4">
                <button id="enterQuizBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-2 rounded">Vào thi</button>
                <button id="exitBtn" class="bg-red-500 hover:bg-red-600 text-white px-8 py-2 rounded">Thoát</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDlMWsv2HFXtkCMyfOp6Qiu34dq14DEPI8",
            authDomain: "toan10-thay-ha.firebaseapp.com",
            projectId: "toan10-thay-ha",
            storageBucket: "toan10-thay-ha.appspot.com",
            messagingSenderId: "490951383067",
            appId: "1:490951383067:web:ac9a0dc073e5e6ce9a00be",
            measurementId: "G-H4N876JFY6"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const QUIZ_ID = "BandemoThayHa0988948882";
        const TIME_LIMIT_SECONDS = 60 * 60;
        const ATTEMPT_LIMIT = 33;

        const originalQuizData = [
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img006_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "D" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img007_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "B" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img008_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "B" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img009_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "C" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img010_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "C" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img011_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "A" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img012_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "B" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img013_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "C" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img014_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "C" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img015_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "B" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img016_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "B" },
            { part: "Phần I: Trắc nghiệm nhiều lựa chọn", type: 'mcq', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img017_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', o: ["A", "B", "C", "D"], a: "D" },
            
            // --- CÂU HỎI MẪU ĐÚNG/SAI BẰNG HÌNH ẢNH ---
            { 
                part: "Phần II: Trắc nghiệm Đúng/Sai", 
                type: 'true-false',
                question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img018_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', 
                s: [ 
                    { text: "Ý a)", a: true }, 
                    { text: "Ý b)", a: true }, 
                    { text: "Ý c)", a: true }, 
                    { text: "Ý d)", a: false } 
                ] 
            },
            { part: "Phần II: Trắc nghiệm Đúng/Sai", type: 'true-false', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img019_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', s: [ { text: "Ý a)", a: true }, { text: "Ý b)", a: false }, { text: "Ý c)", a: false }, { text: "Ý d)", a: true } ] },
            { part: "Phần II: Trắc nghiệm Đúng/Sai", type: 'true-false', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img020_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', s: [ { text: "Ý a)", a: true }, { text: "Ý b)", a: false }, { text: "Ý c)", a: false }, { text: "Ý d)", a: true } ] },
            { part: "Phần II: Trắc nghiệm Đúng/Sai", type: 'true-false', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img021_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', s: [ { text: "Ý a)", a: true }, { text: "Ý b)", a: true }, { text: "Ý c)", a: false }, { text: "Ý d)", a: true } ] },
            
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img022_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "0,79" },
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img023_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "633" },
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img024_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "45" },
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img025_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "55,4" },
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img026_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "0,46" },
            { part: "Phần III: Trả lời ngắn", type: 'short-answer', question: '<img src="https://raw.githubusercontent.com/NVH2020/toanthayha_test/main/Img027_.jpg" alt="Câu hỏi hình ảnh" class="mx-auto my-3 rounded-lg shadow-md max-w-full">', a: "112" },
        ];

        let quizData = [];
        const totalQuestions = originalQuizData.length;
        // ... (phần còn lại của script giữ nguyên)
    </script>
</body>
</html>
